#set($currentPage = $sitevisionUtils.getPortletContextUtil().getCurrentPage())
#set($propertyUtil = $sitevisionUtils.getPropertyUtil())
#set ($session = $request.getSession())
#set ($devmode = $request.getParameter("devmode"))

#if ($devmode == "true")
    $session.setAttribute("useLocalAssets", "local")
#end

#if ($devmode == "false")
    $session.setAttribute("useLocalAssets", "online")
#end

#set ($useLocalAssets = $session.getAttribute('useLocalAssets'))

#if ($useLocalAssets == "local")
    #set ($assetCssMain = "http://localhost:8080/samspel.css")
    #set ($assetJsMain = "http://localhost:8080/samspel.js")
#else

    #set ($assetCssMain = $propertyUtil.getNode($currentPage, 'assetCssMain'))
    #if ($assetCssMain)
        #set ($assetCssMain = $propertyUtil.getString($assetCssMain, 'URI'))
    #else
        #set ($assetCssMain = $propertyUtil.getString($currentPage, 'assetCssMain'))
    #end

    #set ($assetJsMain = $propertyUtil.getNode($currentPage, 'assetJsMain'))
    #if ($assetJsMain)
        #set ($assetJsMain = $propertyUtil.getString($assetJsMain, 'URI'))
    #else
        #set ($assetJsMain = $propertyUtil.getString($currentPage, 'assetJsMain'))
    #end

#end

## assetCssFonts is fetched with AJAX and must always be on same domain as site
#set ($assetCssFonts = $propertyUtil.getNode($currentPage, 'assetCssFonts'))
#if ($assetCssFonts)
    #set ($assetCssFonts = $propertyUtil.getString($assetCssFonts, 'URI'))
#else
    #set ($assetCssFonts = $propertyUtil.getString($currentPage, 'assetCssFonts'))
#end

<link rel="stylesheet" media="all" href="$assetCssMain">
#if ($useLocalAssets == "local")
<script> console.log('Using local assets'); </script>
#end
<script src="$assetJsMain"
        id="js-main"
        data-fonts="$assetCssFonts"></script>


